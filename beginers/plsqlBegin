-- Syntax of the Postgres PL/SQL 

DO $$
DECLARE
    message VARCHAR(20) := 'Hello, world';
BEGIN
    RAISE NOTICE '%', message;
END;
$$;


-- adding two numbers
DO $$
DECLARE
    a INTEGER := 10;
	b INTEGER := 20;
	c INTEGER;
BEGIN
	c := a+b;
    RAISE NOTICE '%', c;
END;
$$;

-- scope of varibales
DO $$
DECLARE
  num1 INTEGER := 95;
  num2 INTEGER := 85;
BEGIN
  RAISE NOTICE 'Outer Variable num1: %', num1;
  RAISE NOTICE 'Outer Variable num2: %', num2;

  -- Inner block
  DECLARE
    num1 INTEGER := 195;
    num2 INTEGER := 185;
  BEGIN
    RAISE NOTICE 'Inner Variable num1: %', num1;
    RAISE NOTICE 'Inner Variable num2: %', num2;
  END;

END;
$$;

-- pl/sql for fetching a record from table

DO $$ 
DECLARE
	c_name employees.name%TYPE;
	c_age employees.age%TYPE;
BEGIN
	SELECT name, age into c_name, c_age from employees where ID = '1';
	RAISE NOTICE 'name: % , age: %', c_name, c_age;
END;
$$;

-- if-else conditions in pl/sql

DO $$
DECLARE 
 salary INTEGER := 1000;
BEGIN
	IF salary>3000 THEN
		RAISE NOTICE 'SALARY IS VERY HIGH';
	ELSEIF salary > 2000 THEN 
		RAISE NOTICE 'SALARY IS HIGH';
	ELSE 
		RAISE NOTICE 'SALARY IS FAIR';
	END IF;
END;
$$;


-- CASE STATEMENTS

DO $$
DECLARE 
 grade CHAR := 'A';
BEGIN
	CASE grade
		WHEN 'A' THEN
			RAISE NOTICE 'EXCELLENT';
		WHEN 'B' THEN
			RAISE NOTICE 'GOOD';
		WHEN 'C' THEN
			RAISE NOTICE 'AVERAGE';
		ELSE
			RAISE NOTICE 'FAIL';
	END CASE;
END;
$$;

-- LOOPS IN PL/SQL
-- BASIC LOOP

DO $$
DECLARE 
 grade CHAR := 'A';
BEGIN
	CASE grade
		WHEN 'A' THEN
			RAISE NOTICE 'EXCELLENT';
		WHEN 'B' THEN
			RAISE NOTICE 'GOOD';
		WHEN 'C' THEN
			RAISE NOTICE 'AVERAGE';
		ELSE
			RAISE NOTICE 'FAIL';
	END CASE;
END;
$$;

-- FOR loop
DO $$
DECLARE 
 grade CHAR := 'A';
BEGIN
	CASE grade
		WHEN 'A' THEN
			RAISE NOTICE 'EXCELLENT';
		WHEN 'B' THEN
			RAISE NOTICE 'GOOD';
		WHEN 'C' THEN
			RAISE NOTICE 'AVERAGE';
		ELSE
			RAISE NOTICE 'FAIL';
	END CASE;
END;
$$;

-- WHILE LOOP
DO $$
DECLARE 
 grade CHAR := 'A';
BEGIN
	CASE grade
		WHEN 'A' THEN
			RAISE NOTICE 'EXCELLENT';
		WHEN 'B' THEN
			RAISE NOTICE 'GOOD';
		WHEN 'C' THEN
			RAISE NOTICE 'AVERAGE';
		ELSE
			RAISE NOTICE 'FAIL';
	END CASE;
END;
$$;

-- FOREACH LOOP

DO $$
DECLARE 
 grade CHAR := 'A';
BEGIN
	CASE grade
		WHEN 'A' THEN
			RAISE NOTICE 'EXCELLENT';
		WHEN 'B' THEN
			RAISE NOTICE 'GOOD';
		WHEN 'C' THEN
			RAISE NOTICE 'AVERAGE';
		ELSE
			RAISE NOTICE 'FAIL';
	END CASE;
END;
$$;

-- FOR LOOP OVER SELECT QUERY
DO $$
DECLARE
    rec RECORD;
BEGIN
    FOR rec IN
        SELECT employee_id, full_name FROM employees ORDER BY employee_id DESC LIMIT 10
    LOOP
        RAISE NOTICE '% - %', rec.employee_id, rec.full_name;
    END LOOP;
END $$;


